<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Generate a \(N \times N\) covariance matrix, \(\Sigma\), by
passing a distance vector of length \(N\), x, to one of the following
covariance functions:
Exponentiated Quadtratic $$\Sigma_{ij} = \sigma^2 \exp \left( \frac{|x_i - x_j|^2}{-2 \ \rho^2} \right)$$
Rational Quadratic $$\Sigma_{ij} = \sigma^2 \left(1 + \frac{|x_i - x_j|^2}{2 \alpha \rho^2} \right)^{-\alpha}$$
Periodic $$\Sigma_{ij} = \sigma^2 \exp \left(\frac{-2 \sin^2(\pi |x_i - x_j|/p)}{\rho^2} \right)$$
Linear $$\Sigma_{ij} = \beta_0 + \beta (x_i - c)(x_j - c)$$
White Noise $$\Sigma_{ij} = \sigma^2 I$$


where \(\sigma^2\) is the amplitude and \(\rho\) is the length_scale
at which the covariance function can operate.
In the rational quadratic kernel, \(\alpha\) is the scale-mixture As
\(\alpha \rightarrow \infty\) the rational quadratic converges to the
exponentiated quadratic.
In the periodic kernel, \(p\) is the period over which the function repeats.
In the linear kernel, \(\beta_0\) and \(\beta\) are intercept and slope
parameters, respectively. \(c\) is a constant that offsets the linear
covariance from the origin.
Finally, in the white noise kernel, \(I\) is the identity matrix."><title>Covariance Functions — cov_exp_quad • riekelib</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Covariance Functions — cov_exp_quad"><meta property="og:description" content="Generate a \(N \times N\) covariance matrix, \(\Sigma\), by
passing a distance vector of length \(N\), x, to one of the following
covariance functions:
Exponentiated Quadtratic $$\Sigma_{ij} = \sigma^2 \exp \left( \frac{|x_i - x_j|^2}{-2 \ \rho^2} \right)$$
Rational Quadratic $$\Sigma_{ij} = \sigma^2 \left(1 + \frac{|x_i - x_j|^2}{2 \alpha \rho^2} \right)^{-\alpha}$$
Periodic $$\Sigma_{ij} = \sigma^2 \exp \left(\frac{-2 \sin^2(\pi |x_i - x_j|/p)}{\rho^2} \right)$$
Linear $$\Sigma_{ij} = \beta_0 + \beta (x_i - c)(x_j - c)$$
White Noise $$\Sigma_{ij} = \sigma^2 I$$


where \(\sigma^2\) is the amplitude and \(\rho\) is the length_scale
at which the covariance function can operate.
In the rational quadratic kernel, \(\alpha\) is the scale-mixture As
\(\alpha \rightarrow \infty\) the rational quadratic converges to the
exponentiated quadratic.
In the periodic kernel, \(p\) is the period over which the function repeats.
In the linear kernel, \(\beta_0\) and \(\beta\) are intercept and slope
parameters, respectively. \(c\) is a constant that offsets the linear
covariance from the origin.
Finally, in the white noise kernel, \(I\) is the identity matrix."><meta property="og:image" content="https://markjrieke.github.io/riekelib/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">riekelib</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/markjrieke/riekelib/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Covariance Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/markjrieke/riekelib/blob/HEAD/R/gp_functions.R" class="external-link"><code>R/gp_functions.R</code></a></small>
      <div class="d-none name"><code>cov_exp_quad.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generate a \(N \times N\) covariance matrix, \(\Sigma\), by
passing a distance vector of length \(N\), <code>x</code>, to one of the following
covariance functions:</p><ul><li><p><strong>Exponentiated Quadtratic</strong> $$\Sigma_{ij} = \sigma^2 \exp \left( \frac{|x_i - x_j|^2}{-2 \ \rho^2} \right)$$</p></li>
<li><p><strong>Rational Quadratic</strong> $$\Sigma_{ij} = \sigma^2 \left(1 + \frac{|x_i - x_j|^2}{2 \alpha \rho^2} \right)^{-\alpha}$$</p></li>
<li><p><strong>Periodic</strong> $$\Sigma_{ij} = \sigma^2 \exp \left(\frac{-2 \sin^2(\pi |x_i - x_j|/p)}{\rho^2} \right)$$</p></li>
<li><p><strong>Linear</strong> $$\Sigma_{ij} = \beta_0 + \beta (x_i - c)(x_j - c)$$</p></li>
<li><p><strong>White Noise</strong> $$\Sigma_{ij} = \sigma^2 I$$</p></li>
</ul><p>where \(\sigma^2\) is the <code>amplitude</code> and \(\rho\) is the <code>length_scale</code>
at which the covariance function can operate.</p>
<p>In the rational quadratic kernel, \(\alpha\) is the scale-mixture As
\(\alpha \rightarrow \infty\) the rational quadratic converges to the
exponentiated quadratic.</p>
<p>In the periodic kernel, \(p\) is the period over which the function repeats.</p>
<p>In the linear kernel, \(\beta_0\) and \(\beta\) are intercept and slope
parameters, respectively. \(c\) is a constant that offsets the linear
covariance from the origin.</p>
<p>Finally, in the white noise kernel, \(I\) is the identity matrix.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cov_exp_quad</span><span class="op">(</span><span class="va">x</span>, amplitude <span class="op">=</span> <span class="fl">1</span>, length_scale <span class="op">=</span> <span class="fl">1</span>, delta <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cov_rational</span><span class="op">(</span><span class="va">x</span>, amplitude <span class="op">=</span> <span class="fl">1</span>, length_scale <span class="op">=</span> <span class="fl">1</span>, mixture <span class="op">=</span> <span class="fl">1</span>, delta <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cov_periodic</span><span class="op">(</span><span class="va">x</span>, amplitude <span class="op">=</span> <span class="fl">1</span>, length_scale <span class="op">=</span> <span class="fl">1</span>, period <span class="op">=</span> <span class="fl">1</span>, delta <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cov_linear</span><span class="op">(</span><span class="va">x</span>, slope <span class="op">=</span> <span class="fl">0</span>, intercept <span class="op">=</span> <span class="fl">0</span>, constant <span class="op">=</span> <span class="fl">0</span>, delta <span class="op">=</span> <span class="fl">1e-09</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cov_noise</span><span class="op">(</span><span class="va">x</span>, amplitude <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A vector containing positions.</p></dd>


<dt>amplitude</dt>
<dd><p>Vertical scale of the covariance function</p></dd>


<dt>length_scale</dt>
<dd><p>Horizontal scale of the covariance function</p></dd>


<dt>delta</dt>
<dd><p>A small offset along the diagonal of the resulting covariance
matrix to ensure the function returns a positive-semidefinite matrix. Can
also be used as a white noise kernel to allow for increased variation at
individual positions along the vector <code>x</code>.</p></dd>


<dt>mixture</dt>
<dd><p>Scale-mixture for the rational quadratic covariance function</p></dd>


<dt>period</dt>
<dd><p>Period of repetition for the periodic covariance function</p></dd>


<dt>slope</dt>
<dd><p>Slope of the linear covariance function</p></dd>


<dt>intercept</dt>
<dd><p>Intercept of the linear covariance function</p></dd>


<dt>constant</dt>
<dd><p>A constant that offsets the linear covariance function along
the x-axis from the origin.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A \(N \times N\) symmetric, positive-semidefinite covariance matrix</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># heatmap of covariance - higher values = greater covariance</span></span></span>
<span class="r-in"><span><span class="fu">cov_exp_quad</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># decreasing the length scale decreases the range over which values covary</span></span></span>
<span class="r-in"><span><span class="fu">cov_exp_quad</span><span class="op">(</span><span class="va">x</span>, length_scale <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rational quadratic includes a mixture parameter</span></span></span>
<span class="r-in"><span><span class="fu">cov_rational</span><span class="op">(</span><span class="va">x</span>, mixture <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># periodic repeats over a distance</span></span></span>
<span class="r-in"><span><span class="fu">cov_periodic</span><span class="op">(</span><span class="va">x</span>, period <span class="op">=</span> <span class="fl">1</span>, length_scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># linear covariance increases/decreases linearly</span></span></span>
<span class="r-in"><span><span class="fu">cov_linear</span><span class="op">(</span><span class="va">x</span>, slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># white noise is applied only along the diagonal</span></span></span>
<span class="r-in"><span><span class="fu">cov_noise</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span>Rowv <span class="op">=</span> <span class="cn">NA</span>, Colv <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cov_exp_quad-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Rieke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

